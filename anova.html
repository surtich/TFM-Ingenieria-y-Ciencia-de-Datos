<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="quarto-1.2.335" />

    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />

    <meta name="dcterms.date" content="2023-03-15" />
    <meta name="description" content="Anova siguiendo capítulo 9 de Lawson." />

    <title>Crossover ANOVA</title>
    <style>
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      div.columns {
        display: flex;
        gap: min(4vw, 1.5em);
      }
      div.column {
        flex: auto;
        overflow-x: auto;
      }
      div.hanging-indent {
        margin-left: 1.5em;
        text-indent: -1.5em;
      }
      ul.task-list {
        list-style: none;
      }
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1.6em;
        vertical-align: middle;
      }
      pre > code.sourceCode {
        white-space: pre;
        position: relative;
      }
      pre > code.sourceCode > span {
        display: inline-block;
        line-height: 1.25;
      }
      pre > code.sourceCode > span:empty {
        height: 1.2em;
      }
      .sourceCode {
        overflow: visible;
      }
      code.sourceCode > span {
        color: inherit;
        text-decoration: inherit;
      }
      div.sourceCode {
        margin: 1em 0;
      }
      pre.sourceCode {
        margin: 0;
      }
      @media screen {
        div.sourceCode {
          overflow: auto;
        }
      }
      @media print {
        pre > code.sourceCode {
          white-space: pre-wrap;
        }
        pre > code.sourceCode > span {
          text-indent: -5em;
          padding-left: 5em;
        }
      }
      pre.numberSource code {
        counter-reset: source-line 0;
      }
      pre.numberSource code > span {
        position: relative;
        left: -4em;
        counter-increment: source-line;
      }
      pre.numberSource code > span > a:first-child::before {
        content: counter(source-line);
        position: relative;
        left: -1em;
        text-align: right;
        vertical-align: baseline;
        border: none;
        display: inline-block;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        padding: 0 4px;
        width: 4em;
        color: #aaaaaa;
      }
      pre.numberSource {
        margin-left: 3em;
        border-left: 1px solid #aaaaaa;
        padding-left: 4px;
      }
      div.sourceCode {
      }
      @media screen {
        pre > code.sourceCode > span > a:first-child::before {
          text-decoration: underline;
        }
      }
      code span.al {
        color: #ff0000;
        font-weight: bold;
      } /* Alert */
      code span.an {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Annotation */
      code span.at {
        color: #7d9029;
      } /* Attribute */
      code span.bn {
        color: #40a070;
      } /* BaseN */
      code span.bu {
        color: #008000;
      } /* BuiltIn */
      code span.cf {
        color: #007020;
        font-weight: bold;
      } /* ControlFlow */
      code span.ch {
        color: #4070a0;
      } /* Char */
      code span.cn {
        color: #880000;
      } /* Constant */
      code span.co {
        color: #60a0b0;
        font-style: italic;
      } /* Comment */
      code span.cv {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* CommentVar */
      code span.do {
        color: #ba2121;
        font-style: italic;
      } /* Documentation */
      code span.dt {
        color: #902000;
      } /* DataType */
      code span.dv {
        color: #40a070;
      } /* DecVal */
      code span.er {
        color: #ff0000;
        font-weight: bold;
      } /* Error */
      code span.ex {
      } /* Extension */
      code span.fl {
        color: #40a070;
      } /* Float */
      code span.fu {
        color: #06287e;
      } /* Function */
      code span.im {
        color: #008000;
        font-weight: bold;
      } /* Import */
      code span.in {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Information */
      code span.kw {
        color: #007020;
        font-weight: bold;
      } /* Keyword */
      code span.op {
        color: #666666;
      } /* Operator */
      code span.ot {
        color: #007020;
      } /* Other */
      code span.pp {
        color: #bc7a00;
      } /* Preprocessor */
      code span.sc {
        color: #4070a0;
      } /* SpecialChar */
      code span.ss {
        color: #bb6688;
      } /* SpecialString */
      code span.st {
        color: #4070a0;
      } /* String */
      code span.va {
        color: #19177c;
      } /* Variable */
      code span.vs {
        color: #4070a0;
      } /* VerbatimString */
      code span.wa {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Warning */
      div.csl-bib-body {
      }
      div.csl-entry {
        clear: both;
      }
      .hanging div.csl-entry {
        margin-left: 2em;
        text-indent: -2em;
      }
      div.csl-left-margin {
        min-width: 2em;
        float: left;
      }
      div.csl-right-inline {
        margin-left: 2em;
        padding-left: 1em;
      }
      div.csl-indent {
        margin-left: 2em;
      }
    </style>

    <script src="anova_files/libs/clipboard/clipboard.min.js"></script>
    <script src="anova_files/libs/quarto-html/quarto.js"></script>
    <script src="anova_files/libs/quarto-html/popper.min.js"></script>
    <script src="anova_files/libs/quarto-html/tippy.umd.min.js"></script>
    <script src="anova_files/libs/quarto-html/anchor.min.js"></script>
    <link href="anova_files/libs/quarto-html/tippy.css" rel="stylesheet" />
    <link
      href="anova_files/libs/quarto-html/quarto-syntax-highlighting.css"
      rel="stylesheet"
      id="quarto-text-highlighting-styles"
    />
    <script src="anova_files/libs/bootstrap/bootstrap.min.js"></script>
    <link
      href="anova_files/libs/bootstrap/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link
      href="anova_files/libs/bootstrap/bootstrap.min.css"
      rel="stylesheet"
      id="quarto-bootstrap"
      data-mode="light"
    />

    <script
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
      type="text/javascript"
    ></script>
  </head>

  <body>
    <div
      id="quarto-content"
      class="page-columns page-rows-contents page-layout-article"
    >
      <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
          <h2 id="toc-title">Table of contents</h2>

          <ul>
            <li>
              <a
                href="#análisis-del-diseño-cruzado-ab-ba-con-anova"
                id="toc-análisis-del-diseño-cruzado-ab-ba-con-anova"
                class="nav-link active"
                data-scroll-target="#análisis-del-diseño-cruzado-ab-ba-con-anova"
                >Análisis del diseño cruzado AB, BA con ANOVA</a
              >
              <ul class="collapse">
                <li>
                  <a
                    href="#preparación-de-datos"
                    id="toc-preparación-de-datos"
                    class="nav-link"
                    data-scroll-target="#preparación-de-datos"
                    >Preparación de datos</a
                  >
                </li>
                <li>
                  <a
                    href="#modelo-nulo."
                    id="toc-modelo-nulo."
                    class="nav-link"
                    data-scroll-target="#modelo-nulo."
                    >Modelo nulo.</a
                  >
                  <ul class="collapse">
                    <li>
                      <a
                        href="#especificación-del-modelo."
                        id="toc-especificación-del-modelo."
                        class="nav-link"
                        data-scroll-target="#especificación-del-modelo."
                        >Especificación del modelo.</a
                      >
                    </li>
                    <li>
                      <a
                        href="#ajuste-del-modelo."
                        id="toc-ajuste-del-modelo."
                        class="nav-link"
                        data-scroll-target="#ajuste-del-modelo."
                        >Ajuste del modelo.</a
                      >
                    </li>
                  </ul>
                </li>
                <li>
                  <a
                    href="#anova-de-un-factor."
                    id="toc-anova-de-un-factor."
                    class="nav-link"
                    data-scroll-target="#anova-de-un-factor."
                    >ANOVA de un factor.</a
                  >
                  <ul class="collapse">
                    <li>
                      <a
                        href="#especificación-del-modelo.-1"
                        id="toc-especificación-del-modelo.-1"
                        class="nav-link"
                        data-scroll-target="#especificación-del-modelo.-1"
                        >Especificación del modelo.</a
                      >
                    </li>
                    <li>
                      <a
                        href="#ajuste-del-modelo.-1"
                        id="toc-ajuste-del-modelo.-1"
                        class="nav-link"
                        data-scroll-target="#ajuste-del-modelo.-1"
                        >Ajuste del modelo.</a
                      >
                    </li>
                    <li>
                      <a
                        href="#tests-estadísticos."
                        id="toc-tests-estadísticos."
                        class="nav-link"
                        data-scroll-target="#tests-estadísticos."
                        >Tests estadísticos.</a
                      >
                    </li>
                  </ul>
                </li>
                <li>
                  <a
                    href="#anova-multifactorial."
                    id="toc-anova-multifactorial."
                    class="nav-link"
                    data-scroll-target="#anova-multifactorial."
                    >ANOVA multifactorial.</a
                  >
                  <ul class="collapse">
                    <li>
                      <a
                        href="#especificación-del-modelo.-2"
                        id="toc-especificación-del-modelo.-2"
                        class="nav-link"
                        data-scroll-target="#especificación-del-modelo.-2"
                        >Especificación del modelo.</a
                      >
                    </li>
                    <li>
                      <a
                        href="#ajuste-del-modelo.-2"
                        id="toc-ajuste-del-modelo.-2"
                        class="nav-link"
                        data-scroll-target="#ajuste-del-modelo.-2"
                        >Ajuste del modelo.</a
                      >
                    </li>
                  </ul>
                </li>
                <li>
                  <a
                    href="#modelo-con-inclusión-de-efecto-carryover."
                    id="toc-modelo-con-inclusión-de-efecto-carryover."
                    class="nav-link"
                    data-scroll-target="#modelo-con-inclusión-de-efecto-carryover."
                    >Modelo con inclusión de efecto <code>carryover</code>.</a
                  >
                  <ul class="collapse">
                    <li>
                      <a
                        href="#especificación-del-modelo.-3"
                        id="toc-especificación-del-modelo.-3"
                        class="nav-link"
                        data-scroll-target="#especificación-del-modelo.-3"
                        >Especificación del modelo.</a
                      >
                    </li>
                    <li>
                      <a
                        href="#ajuste-del-modelo.-3"
                        id="toc-ajuste-del-modelo.-3"
                        class="nav-link"
                        data-scroll-target="#ajuste-del-modelo.-3"
                        >Ajuste del modelo.</a
                      >
                    </li>
                    <li>
                      <a
                        href="#comprobación-de-los-supuestos-del-modelo."
                        id="toc-comprobación-de-los-supuestos-del-modelo."
                        class="nav-link"
                        data-scroll-target="#comprobación-de-los-supuestos-del-modelo."
                        >Comprobación de los supuestos del modelo.</a
                      >
                    </li>
                  </ul>
                </li>
                <li>
                  <a
                    href="#comparación-de-modelos"
                    id="toc-comparación-de-modelos"
                    class="nav-link"
                    data-scroll-target="#comparación-de-modelos"
                    >Comparación de modelos</a
                  >
                </li>
              </ul>
            </li>
          </ul>
        </nav>
      </div>
      <main class="content" id="quarto-document-content">
        <header id="title-block-header" class="quarto-title-block default">
          <div class="quarto-title">
            <h1 class="title">Crossover ANOVA</h1>
          </div>

          <div>
            <div class="description">
              <p>Anova siguiendo capítulo 9 de Lawson.</p>
            </div>
          </div>

          <div class="quarto-title-meta">
            <div>
              <div class="quarto-title-meta-heading">Published</div>
              <div class="quarto-title-meta-contents">
                <p class="date">March 15, 2023</p>
              </div>
            </div>
          </div>
        </header>

        <div class="cell"></div>
        <section
          id="análisis-del-diseño-cruzado-ab-ba-con-anova"
          class="level1"
        >
          <h1>Análisis del diseño cruzado AB, BA con ANOVA</h1>
          <p>
            Vamos a realizar un análisis de la varianza para diseños cruzados
            con dos niveles de factor (bien subtitulado/mal subtitulado) para la
            pregunta 18 del test que es una valoración general del subtitulado.
            Empezaremos realizando una preparación de los datos y
            especificaremos distintos modelos con complejidad creciente.
          </p>
          <section id="preparación-de-datos" class="level2">
            <h2 class="anchored" data-anchor-id="preparación-de-datos">
              Preparación de datos
            </h2>
            <p>TODO: Comentar y poner en bonito la tabla</p>
            <div class="cell">
              <div class="sourceCode cell-code" id="cb1">
                <pre
                  class="sourceCode r code-with-copy"
                ><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>test_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code># A tibble: 174 × 24
     Row Group Test   User LastTry               Q01   Q02   Q03   Q04   Q05
   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1     5 A     01        4 2022-04-13 14:21:55     2     2     2     2     2
 2     4 A     02        4 2022-04-13 14:23:38     2     2     2     2     2
 3    47 B     01       33 2022-04-28 07:52:08     3     3     3     3     1
 4    27 B     02       33 2022-04-28 08:00:20     3     3     3     3     3
 5    85 A     01       35 2022-04-14 02:53:36     4     4     4     4     4
 6    49 A     02       35 2022-04-14 02:58:19     4     3     4     4     3
 7    23 A     01       38 2022-04-15 14:19:38     4     4     4     4     4
 8    15 A     02       38 2022-04-15 14:28:36     0     4     4     4     0
 9    68 A     01       59 2022-04-18 19:12:43     4     4     4     4     4
10    37 A     02       59 2022-04-18 19:22:01     3     2     3     3     1
# … with 164 more rows, and 14 more variables: Q06 &lt;dbl&gt;, Q07 &lt;dbl&gt;, Q08 &lt;dbl&gt;,
#   Q09 &lt;dbl&gt;, Q10 &lt;dbl&gt;, Q11 &lt;dbl&gt;, Q12 &lt;dbl&gt;, Q13 &lt;dbl&gt;, Q14 &lt;dbl&gt;,
#   Q15 &lt;dbl&gt;, Q16 &lt;dbl&gt;, Q17 &lt;dbl&gt;, Q18 &lt;dbl&gt;, Rows &lt;int&gt;</code></pre>
              </div>
            </div>
            <p>Disponemos de estos datos:</p>
            <div class="cell">
              <div class="sourceCode cell-code" id="cb3">
                <pre
                  class="sourceCode r code-with-copy"
                ><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>test_df <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Group, Test) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>     Test
Group 01 02
    A 43 43
    B 44 44</code></pre>
              </div>
            </div>
            <p>
              Vamos a cambiar la nomenclatura para adaptarla a
              <span class="citation" data-cites="lawson2018"
                >Lawson (<a href="#ref-lawson2018" role="doc-biblioref">2018</a
                >)</span
              >:
            </p>
            <ul>
              <li><p>El grupo A pasará a llamarse AB.</p></li>
              <li><p>El grupo B pasará a llamarse BA.</p></li>
              <li><p>Los estudiantes se denominarán sujetos.</p></li>
              <li><p>Los test 01 y 02 tratamientos.</p></li>
              <li><p>Se introduce una variable periodo.</p></li>
            </ul>
            <p>
              Los valores del test de Likert se desplazarán para que tengan
              valores más lógicos:
            </p>
            <ul>
              <li>0 = No sé / No constesto</li>
              <li>1 = Muy en desacuerdo</li>
              <li>2 = En desacuerdo</li>
              <li>3 = Neutral</li>
              <li>4 = De acuerdo</li>
              <li>5 = Muy de acuerdo</li>
            </ul>
            <p>Finalmente la tabla se pasará a formato largo.</p>
            <div class="cell"></div>
            <div class="cell">
              <div class="cell-output cell-output-stdout">
                <pre><code># A tibble: 3,132 × 6
   Group Period Treat Subject Item Response
   &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt;   &lt;chr&gt;       &lt;dbl&gt;
 1 AB    1      A     4       Q01             3
 2 AB    1      A     4       Q02             3
 3 AB    1      A     4       Q03             3
 4 AB    1      A     4       Q04             3
 5 AB    1      A     4       Q05             3
 6 AB    1      A     4       Q06             3
 7 AB    1      A     4       Q07             3
 8 AB    1      A     4       Q08             3
 9 AB    1      A     4       Q09             3
10 AB    1      A     4       Q10             3
# … with 3,122 more rows</code></pre>
              </div>
            </div>
            <p>
              El análisis de la varianza, ANOVA, se debe realizar una variable
              de respuesta cuantitativo (TODO: incluir supuestos de ANOVA). El
              test de Likert tiene una escala ordinal y, por lo tanto, ANOVA no
              es una técnica adecuada.
            </p>
          </section>
          <section id="modelo-nulo." class="level2">
            <h2 class="anchored" data-anchor-id="modelo-nulo.">Modelo nulo.</h2>
            <section id="especificación-del-modelo." class="level3">
              <h3 class="anchored" data-anchor-id="especificación-del-modelo.">
                Especificación del modelo.
              </h3>
              <p>
                Vamos a comenzar ajustando el modelo nulo que es aquel que no
                tiene predictores. La ecuación del modelo nulos será:
              </p>
              <p>
                <span id="eq-anova-1.1"
                  ><span class="math display"
                    >\[ Y \sim N(\mu, \sigma^2), \textrm{ independientes}
                    \tag{1}\]</span
                  ></span
                >
              </p>
              <p>
                Los valores observados
                <span class="math inline">\(y\)</span> corresponden a las
                respuestas a la pregunta 18 y siguen una distribución normal con
                media <span class="math inline">\(\mu\)</span> y varianza
                <span class="math inline">\(\sigma^2\)</span>. Es decir, que
                estamos suponiendo que todas las respuestas tienen la misma
                media.
              </p>
              <p>
                El modelo (<a href="#eq-anova-1.1">Equation&nbsp;1</a>) también
                se puede expresar:
              </p>
              <p>
                <span id="eq-one-anova-1.2"
                  ><span class="math display"
                    >\[ y = \mu + \epsilon \tag{2}\]</span
                  ></span
                >
              </p>
              <p>
                Con
                <span class="math inline"
                  >\(\epsilon \textrm{ i.i.d.} \sim N(0,\sigma^2)\)</span
                >. En esta ecuación simplemente hemos separado el término
                determinista <span class="math inline">\(\mu\)</span> del
                estocástico <span class="math inline">\(\epsilon\)</span>.
              </p>
            </section>
            <section id="ajuste-del-modelo." class="level3">
              <h3 class="anchored" data-anchor-id="ajuste-del-modelo.">
                Ajuste del modelo.
              </h3>
              <p>
                Finalmente ajustamos el modelo y mostramos los coeficientes:
              </p>
              <div class="cell">
                <div class="sourceCode cell-code" id="cb6">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">aov</span>(Response <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df18)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>coef<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit<span class="fl">.1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>coef<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
                <div class="cell-output cell-output-stdout">
                  <pre><code>(Intercept) 
   3.672414 </code></pre>
                </div>
              </div>
              <p>
                El valor ajustado del intercepto se corresponde con las media de
                las preguntas.
              </p>
            </section>
          </section>
          <section id="anova-de-un-factor." class="level2">
            <h2 class="anchored" data-anchor-id="anova-de-un-factor.">
              ANOVA de un factor.
            </h2>
            <p>
              En este apartado seguimos el desarrollo descrito en
              <span class="citation" data-cites="meier2022"
                >Meier (<a href="#ref-meier2022" role="doc-biblioref">2022</a
                >)</span
              >
              (chap.&nbsp;2).
            </p>
            <section id="especificación-del-modelo.-1" class="level3">
              <h3
                class="anchored"
                data-anchor-id="especificación-del-modelo.-1"
              >
                Especificación del modelo.
              </h3>
              <p>
                El principal efecto que queremos conocer es el efecto que tiene
                la calidad del subtitulado sobre las respuestas de los
                estudiantes. Incluimos en el modelo la calidad del subtitulado.
                El nuevo modelo será:
              </p>
              <p>
                <span id="eq-one-anova-2.1"
                  ><span class="math display"
                    >\[ Y_{i} \sim N(\mu_i, \sigma^2), \textrm{ independientes}
                    \tag{3}\]</span
                  ></span
                >
              </p>
              <p>
                Los valores observados
                <span class="math inline">\(y_{i}\)</span> corresponden a las
                respuestas a la pregunta 18 del i-ésimo tratamiento (A o B) y
                siguen una distribución normal con media
                <span class="math inline">\(\mu_i\)</span> y varianza
                <span class="math inline">\(\sigma^2\)</span>. Es decir, que
                estamos suponiendo que los dos tratamientos tienen la misma
                varianza pero pueden tener distinta media.
              </p>
              <p>
                El modelo (<a href="#eq-one-anova-2.1">Equation&nbsp;3</a>)
                también se puede expresar:
              </p>
              <p>
                <span id="eq-one-anova-2.2"
                  ><span class="math display"
                    >\[ y_{i} = \mu_i + \epsilon_{i} \tag{4}\]</span
                  ></span
                >
              </p>
              <p>
                Con
                <span class="math inline"
                  >\(\epsilon_{i} \textrm{ i.i.d.} \sim N(0,\sigma^2)\)</span
                >. En esta ecuación simplemente hemos separado el término
                determinista <span class="math inline">\(\mu_i\)</span> del
                estocástico <span class="math inline">\(\epsilon_{ij}\)</span>.
              </p>
              <p>Una reparametrización alternativa es:</p>
              <p>
                <span id="eq-one-anova-2.3"
                  ><span class="math display"
                    >\[ y_{i} = \mu + \tau_i + \epsilon_{i} \tag{5}\]</span
                  ></span
                >
              </p>
              <p>
                En este caso, estamos considerando que existe un efecto fijo,
                <span class="math inline">\(\mu\)</span>, y que cada factor
                tiene una desviación,
                <span class="math inline">\(\tau_i\)</span>, sobre el nivel
                fijo. Así,
                <span class="math inline"
                  >\(\displaystyle \sum \tau_i = 0\)</span
                >. Lo que en nuestro caso, en el que sólo hay dos niveles,
                implica que
                <span class="math inline">\(\tau_A + \tau_B = 0\)</span>. En R
                se puede elegir uno (<a href="#eq-one-anova-2.1"
                  >Equation&nbsp;3</a
                >) u otro (<a href="#eq-one-anova-2.2">Equation&nbsp;4</a>) tipo
                de parametrización al ajustar el modelo.
              </p>
            </section>
            <section id="ajuste-del-modelo.-1" class="level3">
              <h3 class="anchored" data-anchor-id="ajuste-del-modelo.-1">
                Ajuste del modelo.
              </h3>
              <p>
                Podemos comprobar que los valores de respuesta de cada nivel de
                tratamiento están claramente separados:
              </p>
              <div class="cell">
                <div class="cell-output-display">
                  <div class="quarto-figure quarto-figure-center">
                    <figure class="figure">
                      <p>
                        <img
                          src="anova_files/figure-html/unnamed-chunk-10-1.png"
                          class="img-fluid figure-img"
                          width="672"
                        />
                      </p>
                      <p></p>
                      <figcaption class="figure-caption">
                        Resumen de las respuestas a la pregunta 18 en cada nivel
                        de tratamiento.
                      </figcaption>
                      <p></p>
                    </figure>
                  </div>
                </div>
              </div>
              <p>
                Finalmente ajustamos el modelo y mostramos los coeficientes:
              </p>
              <div class="cell">
                <div class="sourceCode cell-code" id="cb8">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">aov</span>(Response <span class="sc">~</span> Treat, <span class="at">data =</span> df18)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>coef<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit<span class="fl">.2</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>coef<span class="fl">.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
                <div class="cell-output cell-output-stdout">
                  <pre><code>(Intercept)      TreatB 
   4.459770   -1.574713 </code></pre>
                </div>
              </div>
              <p>
                Por defecto R elige como nivel de referencia del factor el A por
                ser menor alfabéticamente y el término de intercepción se
                corresponde con este valor, así
                <span class="math inline">\(\mu_A=4.46\)</span> y el nivel del
                tratamiento B está como diferencias sobre el de referencia. Por
                lo tanto, <span class="math inline">\(\mu_B=2.89\)</span>.
              </p>
              <p>
                Alternativamente podemos obtener las medias de cada nivel de
                esta forma:
              </p>
              <div class="cell">
                <div class="sourceCode cell-code" id="cb10">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit<span class="fl">.2</span>, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Treat =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
                <div class="cell-output cell-output-stdout">
                  <pre><code>       1        2 
4.459770 2.885057 </code></pre>
                </div>
              </div>
              <p>
                O con la librería <code>emmeans</code>, que también nos
                proporciona el intervalo de confianza con el 95%:
              </p>
              <div class="cell">
                <div class="sourceCode cell-code" id="cb12">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(fit<span class="fl">.2</span>, <span class="at">specs =</span> <span class="sc">~</span>Treat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
                <div class="cell-output cell-output-stdout">
                  <pre><code> Treat emmean   SE  df lower.CL upper.CL
 A       4.46 0.11 172     4.24     4.68
 B       2.89 0.11 172     2.67     3.10

Confidence level used: 0.95 </code></pre>
                </div>
              </div>
              <p>
                Con R, podemos obtener los valores correspondientes a la segunda
                parametrización (<a href="#eq-one-anova-2.3">Equation&nbsp;5</a
                >) del modelo:
              </p>
              <div class="cell">
                <div class="sourceCode cell-code" id="cb14">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">"contr.sum"</span>, <span class="st">"contr.poly"</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fit.<span class="fl">2.</span>bis <span class="ot">&lt;-</span> <span class="fu">aov</span>(Response <span class="sc">~</span> Treat, <span class="at">data =</span> df18)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>coef.<span class="fl">2.</span>bis <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit.<span class="fl">2.</span>bis)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>coef.<span class="fl">2.</span>bis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
                <div class="cell-output cell-output-stdout">
                  <pre><code>(Intercept)      Treat1 
  3.6724138   0.7873563 </code></pre>
                </div>
                <div class="sourceCode cell-code" id="cb16">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">"contr.treatment"</span>, <span class="st">"contr.poly"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
              </div>
              <p>
                Vemos que cambian tanto los valores como el esquema de nombrado.
                Ahora el intercepto se corresponde con la media global (<span
                  class="math inline"
                  >\(\mu=3.67\)</span
                >) y <code>Treat1</code> es la diferencia del nivel de factor 1
                con esa media (<span class="math inline">\(\tau_A=0.79\)</span
                >). Como la suma de todos los niveles tiene que ser 0,
                <span class="math inline">\(\tau_B=-0.79\)</span>.
              </p>
            </section>
            <section id="tests-estadísticos." class="level3">
              <h3 class="anchored" data-anchor-id="tests-estadísticos.">
                Tests estadísticos.
              </h3>
              <p>
                En ANOVA se contrasta si las medias de los niveles de un factor
                son iguales o hay alguna diferente:
              </p>
              <p>
                <span class="math display"
                  >\[ \begin{array}{lll} H_0 &amp; : &amp; \mu_1 = \mu_2 =
                  \ldots = \mu_g \\ H_A &amp; : &amp; \mu_k \neq \mu_l \textrm{
                  para al menos un par } k \neq l \\ \end{array} \]</span
                >
              </p>
              <p>
                Los resultados de <span class="math inline">\(F\)</span>-test
                son significativos y permiten rechazar la hipótesis nula de que
                los dos tratamientos son iguales, es decir que podemos concluir
                que el subtitulado de los vídeos es percibido por los
                estudiantes con diferente:
              </p>
              <div class="cell">
                <div class="sourceCode cell-code" id="cb17">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
                <div class="cell-output cell-output-stdout">
                  <pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
Treat         1  107.9  107.87   101.7 &lt;2e-16 ***
Residuals   172  182.5    1.06                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
                </div>
              </div>
              <p>
                Podemos calcular el estadístico
                <span class="math inline">\(F\)</span> usando un test
                <span class="math inline">\(drop1\)</span> que consiste en
                ajustar el modelo con y sin variables predictoras y comparar los
                resultados:
              </p>
              <div class="cell">
                <div class="sourceCode cell-code" id="cb19">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(fit<span class="fl">.2</span>, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
                <div class="cell-output cell-output-stdout">
                  <pre><code>Single term deletions

Model:
Response ~ Treat
       Df Sum of Sq    RSS    AIC F value    Pr(&gt;F)    
&lt;none&gt;              182.46 12.261                      
Treat   1    107.87 290.33 91.080  101.68 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
                </div>
              </div>
              <p>
                Una tercera forma de obtener los mismos resultados es comparar
                mediante un <span class="math inline">\(F\)</span>-test el
                modelo con un factor con el modelo nulo:
              </p>
              <div class="cell">
                <div class="sourceCode cell-code" id="cb21">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit<span class="fl">.1</span>, fit<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
                <div class="cell-output cell-output-stdout">
                  <pre><code>Analysis of Variance Table

Model 1: Response ~ 1
Model 2: Response ~ Treat
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1    173 290.33                                  
2    172 182.46  1    107.87 101.68 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
                </div>
              </div>
              <p>
                Podemos obtener las significación estadística y los intervalos
                de confianza de los
                <span class="math inline">\(\tau_i's\)</span>:
              </p>
              <div class="cell">
                <div class="sourceCode cell-code" id="cb23">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.lm</span>(fit<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
                <div class="cell-output cell-output-stdout">
                  <pre><code>
Call:
aov(formula = Response ~ Treat, data = df18)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4598 -0.8851  0.1149  0.5402  2.1149 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   4.4598     0.1104   40.39   &lt;2e-16 ***
TreatB       -1.5747     0.1562  -10.08   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.03 on 172 degrees of freedom
Multiple R-squared:  0.3715,    Adjusted R-squared:  0.3679 
F-statistic: 101.7 on 1 and 172 DF,  p-value: &lt; 2.2e-16</code></pre>
                </div>
              </div>
              <div class="cell">
                <div class="sourceCode cell-code" id="cb25">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fit<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
                <div class="cell-output cell-output-stdout">
                  <pre><code>                2.5 %    97.5 %
(Intercept)  4.241811  4.677729
TreatB      -1.882953 -1.266472</code></pre>
                </div>
              </div>
            </section>
          </section>
          <section id="anova-multifactorial." class="level2">
            <h2 class="anchored" data-anchor-id="anova-multifactorial.">
              ANOVA multifactorial.
            </h2>
            <p>
              Siguiendo a
              <span class="citation" data-cites="lawson2018"
                >Lawson (<a href="#ref-lawson2018" role="doc-biblioref"
                  >2018, 353–54</a
                >)</span
              >
              vamos a realizar un ajuste para tres factores: Subtítulos (Treat),
              periodo (Period) y estudiantes (Subject).
            </p>
            <section id="especificación-del-modelo.-2" class="level3">
              <h3
                class="anchored"
                data-anchor-id="especificación-del-modelo.-2"
              >
                Especificación del modelo.
              </h3>
              <p>El modelo quedará especificado con la siguiente fórmula:</p>
              <p>
                <span id="eq-one-anova-3"
                  ><span class="math display"
                    >\[ y_{ijk} = \mu + s_i + \pi_j + \tau_k + \epsilon_{ijk}
                    \tag{6}\]</span
                  ></span
                >
              </p>
              <p>Donde,</p>
              <ul>
                <li>
                  <p>
                    <span class="math inline">\(y_{ijk}\)</span> es una
                    observación de la respuesta a la pregunta 18 del test del
                    sujeto <span class="math inline">\(i\)</span>-èsimo, en el
                    periodo <span class="math inline">\(j\)</span>-èsimo y con
                    el subtitulado <span class="math inline">\(k\)</span>-èsimo.
                  </p>
                </li>
                <li>
                  <p>
                    <span class="math inline">\(\mu\)</span> es el valor fijo de
                    respuesta independiente del nivel de factor.
                  </p>
                </li>
                <li>
                  <p>
                    <span class="math inline">\(s_i\)</span> es el efecto
                    aleatorizado del sujeto (factor de bloque).
                  </p>
                </li>
                <li>
                  <p>
                    <span class="math inline">\(\pi_j\)</span> es el efecto
                    periodo.
                  </p>
                </li>
                <li>
                  <p>
                    <span class="math inline">\(\tau_j\)</span> es el efecto
                    tratamiento (subtítulo).
                  </p>
                </li>
                <li>
                  <p>
                    <span class="math inline">\(\epsilon_{ijk}\)</span> es el
                    error no explicado.
                  </p>
                </li>
                <li><p>El efecto de grupo no se incluye en este modelo.</p></li>
              </ul>
            </section>
            <section id="ajuste-del-modelo.-2" class="level3">
              <h3 class="anchored" data-anchor-id="ajuste-del-modelo.-2">
                Ajuste del modelo.
              </h3>
              <p>
                Usamos un modelo de Anova tipo III que corresponde a un modelo
                completo en vez del tipo I (secuencial) usado por defecto, ya
                que las respuestas no están perfectamente balanceadas.
              </p>
              <div class="cell">
                <div class="sourceCode cell-code" id="cb27">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(Response <span class="sc">~</span> Subject <span class="sc">+</span> Period <span class="sc">+</span> Treat,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df18,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">contrasts =</span> <span class="fu">list</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">Subject =</span> contr.sum, <span class="at">Period =</span> contr.sum,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">Treat =</span> contr.sum</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(fit<span class="fl">.3</span>, <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
                <div class="cell-output cell-output-stdout">
                  <pre><code>Anova Table (Type III tests)

Response: Response
             Sum Sq Df   F value    Pr(&gt;F)    
(Intercept) 2346.67  1 2190.6680 &lt; 2.2e-16 ***
Subject       89.83 86    0.9751    0.5465    
Period         1.58  1    1.4741    0.2281    
Treat        108.15  1  100.9638 4.112e-16 ***
Residuals     91.05 85                        
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
                </div>
              </div>
              <p>
                Podemos constatar un efecto significativo de los subtítulos, que
                indica que hay una diferencia en las respuestas a la pregunta 18
                sobre la valoración general del subtitulado de los vídeos. Sin
                embargo no hay efecto periodo significativo.
              </p>
              <p>
                Con la función lsmeans podemos contrastar la diferencia de
                niveles de tratamiento:
              </p>
              <div class="cell">
                <div class="sourceCode cell-code" id="cb29">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lsmeans</span>(fit<span class="fl">.3</span>, pairwise <span class="sc">~</span> Treat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
                <div class="cell-output cell-output-stdout">
                  <pre><code>$lsmeans
 Treat lsmean    SE df lower.CL upper.CL
 A       4.46 0.111 85     4.24     4.68
 B       2.88 0.111 85     2.66     3.10

Results are averaged over the levels of: Subject, Period 
Confidence level used: 0.95 

$contrasts
 contrast estimate    SE df t.ratio p.value
 A - B        1.58 0.157 85  10.048  &lt;.0001

Results are averaged over the levels of: Subject, Period </code></pre>
                </div>
              </div>
            </section>
          </section>
          <section
            id="modelo-con-inclusión-de-efecto-carryover."
            class="level2"
          >
            <h2
              class="anchored"
              data-anchor-id="modelo-con-inclusión-de-efecto-carryover."
            >
              Modelo con inclusión de efecto <code>carryover</code>.
            </h2>
            <p>
              Podemos evaluar si efecto del tratamiento del primer periodo
              afecta a los resultados obtenidos en el segundo periodo. Este
              efecto es conocido como <code>carryover</code>.
            </p>
            <section id="especificación-del-modelo.-3" class="level3">
              <h3
                class="anchored"
                data-anchor-id="especificación-del-modelo.-3"
              >
                Especificación del modelo.
              </h3>
              <p>
                Siguiendo a
                <span class="citation" data-cites="lawson2018"
                  >Lawson (<a href="#ref-lawson2018" role="doc-biblioref"
                    >2018</a
                  >)</span
                >
                (pags. 356-357), el modelo propuesto será:
              </p>
              <p>
                <span id="eq-one-anova-4"
                  ><span class="math display"
                    >\[ y_{ijkl} = \mu + \psi_i + s_{ij} + \pi_k + \tau_l +
                    \epsilon_{ijkl} \tag{7}\]</span
                  ></span
                >
              </p>
              <p>
                Sobre el modelo anterior (<a href="#eq-one-anova-3"
                  >Equation&nbsp;6</a
                >) se ha añadido el efecto aleatorio <code>carryover</code>
                <span class="math inline">\(\psi_i\)</span>, que representa el
                efecto <code>carryover</code> de grupo
                <a
                  href="#fn1"
                  class="footnote-ref"
                  id="fnref1"
                  role="doc-noteref"
                  ><sup>1</sup></a
                >
                y <span class="math inline">\(s_{ij}\)</span> es ahora un efecto
                aleatorio del sujeto
                <span class="math inline">\(i\)</span>-ésimo en el grupo
                <span class="math inline">\(j\)</span>-èsimo. El resto de
                términos mantienen su significado.
              </p>
            </section>
            <section id="ajuste-del-modelo.-3" class="level3">
              <h3 class="anchored" data-anchor-id="ajuste-del-modelo.-3">
                Ajuste del modelo.
              </h3>
              <p>
                Para evaluar el efecto <code>carryover</code> el efecto fijo
                Subject del modelo anterior (<a href="#eq-one-anova-3"
                  >Equation&nbsp;6</a
                >) se ha sustituido por un efecto aleatorio de la interacción
                entre sujeto y grupo.
              </p>
              <div class="cell">
                <div class="sourceCode cell-code" id="cb31">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Response <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Group <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Subject<span class="sc">:</span>Group) <span class="sc">+</span> Period <span class="sc">+</span> Treat,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df18,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">contrasts =</span> <span class="fu">list</span>(</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">Group =</span> c1, <span class="at">Period =</span> c1, <span class="at">Treat =</span> c1</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
                <div class="cell-output cell-output-stderr">
                  <pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
                </div>
                <div class="sourceCode cell-code" id="cb33">
                  <pre
                    class="sourceCode r code-with-copy"
                  ><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                </div>
                <div class="cell-output cell-output-stdout">
                  <pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: Response ~ 1 + Group + (1 | Subject:Group) + Period + Treat
   Data: df18

REML criterion at convergence: 509.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2609 -0.7665  0.2029  0.6169  2.1418 

Random effects:
 Groups        Name        Variance Std.Dev.
 Subject:Group (Intercept) 0.000    0.000   
 Residual                  1.064    1.032   
Number of obs: 174, groups:  Subject:Group, 87

Fixed effects:
             Estimate Std. Error        df t value Pr(&gt;|t|)    
(Intercept) 3.672e+00  7.820e-02 1.700e+02  46.960   &lt;2e-16 ***
Group1      3.964e-03  1.564e-01 1.700e+02   0.025    0.980    
Period1     1.905e-01  1.564e-01 1.700e+02   1.218    0.225    
Treat1      1.577e+00  1.564e-01 1.700e+02  10.082   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
        (Intr) Group1 Perid1
Group1  0.011               
Period1 0.000  0.000        
Treat1  0.000  0.000  0.011 
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
                </div>
              </div>
              <p>
                Vemos que no hay evidencia significativa ni de efecto de grupo
                ni de efecto <code>carryover</code>. La varianza explicada del
                efecto <code>carryover</code> es cero. El efecto tratamiento
                sigue siendo significativo.
              </p>
            </section>
            <section
              id="comprobación-de-los-supuestos-del-modelo."
              class="level3"
            >
              <h3
                class="anchored"
                data-anchor-id="comprobación-de-los-supuestos-del-modelo."
              >
                Comprobación de los supuestos del modelo.
              </h3>
              <p>
                La inferencia estadística solo es válida si se cumplen las
                siguientes premisas:
              </p>
              <ul>
                <li>Los errores son independientes.</li>
                <li>Los errores están distribuidos normalmente.</li>
                <li>La varianza del error es constante.</li>
                <li>Los errores tienen una media de cero.</li>
              </ul>
              <p>
                La independencia de los errores se consigue aleatorizando el
                experimento. Habría que hacer comprobaciones estadísticas de la
                representatividad de la muestra que no se abordan en este
                trabajo por no ser objeto del mismo. En cualquier caso, en un
                estudio cruzado los errores no son independientes y trataremos
                este problema más adelante.
              </p>
              <section id="análisis-de-residuos" class="level4">
                <h4 class="anchored" data-anchor-id="análisis-de-residuos">
                  Análisis de residuos
                </h4>
                <p>
                  No observamos directamente los errores,
                  <span class="math inline">\(\epsilon\)</span>, sino una
                  estimación suya que denominamos residuos:
                </p>
                <p>
                  <span class="math display">\[ r = y - \widehat{\mu}. \]</span>
                </p>
                <p>
                  Para comprobar la normalidad de los residuos es habitual
                  utilizar un gráfico <strong>QQ-plot</strong> que compara los
                  percentiles de los residuos obtenidos de tras ajustar el
                  modelo con los que resultarían de un distribución normal.
                </p>
                <div class="cell">
                  <div class="sourceCode cell-code" id="cb35">
                    <pre
                      class="sourceCode r code-with-copy"
                    ><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                  </div>
                  <div class="cell-output-display">
                    <div class="quarto-figure quarto-figure-center">
                      <figure class="figure">
                        <p>
                          <img
                            src="anova_files/figure-html/unnamed-chunk-23-1.png"
                            class="img-fluid figure-img"
                            width="672"
                          />
                        </p>
                        <p></p>
                        <figcaption class="figure-caption">
                          QQ-plot para comprobar la normalidad de los residuos.
                        </figcaption>
                        <p></p>
                      </figure>
                    </div>
                  </div>
                </div>
                <p>
                  Como era de esperar, una variable de respuesta ordinal no va a
                  producir residuos con distribución normal.
                </p>
                <p>
                  Si los residuos no tienen una distribución normal, el resto de
                  test que hagamos carecen de sentido ya parten de la premisa de
                  que los residuos son normales.
                </p>
              </section>
            </section>
          </section>
          <section id="comparación-de-modelos" class="level2">
            <h2 class="anchored" data-anchor-id="comparación-de-modelos">
              Comparación de modelos
            </h2>
            <p>TODO</p>
          </section>
        </section>

        <div id="quarto-appendix" class="default">
          <section class="quarto-appendix-contents" role="doc-bibliography">
            <h2 class="anchored quarto-appendix-heading">References</h2>
            <div
              id="refs"
              class="references csl-bib-body hanging-indent"
              role="doc-bibliography"
            >
              <div id="ref-lawson2018" class="csl-entry" role="doc-biblioentry">
                Lawson, John E. 2018.
                <em>Design and Analysis of Experiments</em>. 1st ed. Chapman;
                Hall/CRC.
                <a
                  href="https://www.taylorfrancis.com/books/mono/10.1201/b17883/design-analysis-experiments-john-lawson"
                  >https://www.taylorfrancis.com/books/mono/10.1201/b17883/design-analysis-experiments-john-lawson</a
                >.
              </div>
              <div id="ref-meier2022" class="csl-entry" role="doc-biblioentry">
                Meier, Lukas. 2022.
                <em>ANOVA and Mixed Models: A Short Introduction Using r</em>.
                Chapman; Hall/CRC.
                <a
                  href="https://www.taylorfrancis.com/books/mono/10.1201/9781003146216/anova-mixed-models-lukas-meier"
                  >https://www.taylorfrancis.com/books/mono/10.1201/9781003146216/anova-mixed-models-lukas-meier</a
                >.
              </div>
            </div>
          </section>
          <section
            id="footnotes"
            class="footnotes footnotes-end-of-document"
            role="doc-endnotes"
          >
            <h2 class="anchored quarto-appendix-heading">Footnotes</h2>

            <ol>
              <li id="fn1">
                <p>
                  En realidad hay dos efectos <code>carryover</code>: uno de
                  pasar del tratamiento A al B y otro del B a A. Según
                  <span class="citation" data-cites="lawson2018"
                    >Lawson (<a href="#ref-lawson2018" role="doc-biblioref"
                      >2018</a
                    >)</span
                  >, si asumimos que los efectos <code>carryover</code> son
                  diferentes, la estimación de la diferencia de tratamientos
                  queda sesgada por lo que se debe asumir que los efectos
                  <code>carryover</code> son de la misma magnitud y por eso en
                  nuestro modelo solo aparece un término para este efecto.<a
                    href="#fnref1"
                    class="footnote-back"
                    role="doc-backlink"
                    >↩︎</a
                  >
                </p>
              </li>
            </ol>
          </section>
        </div>
      </main>
      <!-- /main column -->
      <script id="quarto-html-after-body" type="application/javascript">
        window.document.addEventListener("DOMContentLoaded", function (event) {
          const toggleBodyColorMode = (bsSheetEl) => {
            const mode = bsSheetEl.getAttribute("data-mode");
            const bodyEl = window.document.querySelector("body");
            if (mode === "dark") {
              bodyEl.classList.add("quarto-dark");
              bodyEl.classList.remove("quarto-light");
            } else {
              bodyEl.classList.add("quarto-light");
              bodyEl.classList.remove("quarto-dark");
            }
          };
          const toggleBodyColorPrimary = () => {
            const bsSheetEl = window.document.querySelector(
              "link#quarto-bootstrap"
            );
            if (bsSheetEl) {
              toggleBodyColorMode(bsSheetEl);
            }
          };
          toggleBodyColorPrimary();
          const icon = "";
          const anchorJS = new window.AnchorJS();
          anchorJS.options = {
            placement: "right",
            icon: icon,
          };
          anchorJS.add(".anchored");
          const clipboard = new window.ClipboardJS(".code-copy-button", {
            target: function (trigger) {
              return trigger.previousElementSibling;
            },
          });
          clipboard.on("success", function (e) {
            // button target
            const button = e.trigger;
            // don't keep focus
            button.blur();
            // flash "checked"
            button.classList.add("code-copy-button-checked");
            var currentTitle = button.getAttribute("title");
            button.setAttribute("title", "Copied!");
            let tooltip;
            if (window.bootstrap) {
              button.setAttribute("data-bs-toggle", "tooltip");
              button.setAttribute("data-bs-placement", "left");
              button.setAttribute("data-bs-title", "Copied!");
              tooltip = new bootstrap.Tooltip(button, {
                trigger: "manual",
                customClass: "code-copy-button-tooltip",
                offset: [0, -8],
              });
              tooltip.show();
            }
            setTimeout(function () {
              if (tooltip) {
                tooltip.hide();
                button.removeAttribute("data-bs-title");
                button.removeAttribute("data-bs-toggle");
                button.removeAttribute("data-bs-placement");
              }
              button.setAttribute("title", currentTitle);
              button.classList.remove("code-copy-button-checked");
            }, 1000);
            // clear code selection
            e.clearSelection();
          });
          function tippyHover(el, contentFn) {
            const config = {
              allowHTML: true,
              content: contentFn,
              maxWidth: 500,
              delay: 100,
              arrow: false,
              appendTo: function (el) {
                return el.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: "quarto",
              placement: "bottom-start",
            };
            window.tippy(el, config);
          }
          const noterefs = window.document.querySelectorAll(
            'a[role="doc-noteref"]'
          );
          for (var i = 0; i < noterefs.length; i++) {
            const ref = noterefs[i];
            tippyHover(ref, function () {
              // use id or data attribute instead here
              let href =
                ref.getAttribute("data-footnote-href") ||
                ref.getAttribute("href");
              try {
                href = new URL(href).hash;
              } catch {}
              const id = href.replace(/^#\/?/, "");
              const note = window.document.getElementById(id);
              return note.innerHTML;
            });
          }
          const findCites = (el) => {
            const parentEl = el.parentElement;
            if (parentEl) {
              const cites = parentEl.dataset.cites;
              if (cites) {
                return {
                  el,
                  cites: cites.split(" "),
                };
              } else {
                return findCites(el.parentElement);
              }
            } else {
              return undefined;
            }
          };
          var bibliorefs = window.document.querySelectorAll(
            'a[role="doc-biblioref"]'
          );
          for (var i = 0; i < bibliorefs.length; i++) {
            const ref = bibliorefs[i];
            const citeInfo = findCites(ref);
            if (citeInfo) {
              tippyHover(citeInfo.el, function () {
                var popup = window.document.createElement("div");
                citeInfo.cites.forEach(function (cite) {
                  var citeDiv = window.document.createElement("div");
                  citeDiv.classList.add("hanging-indent");
                  citeDiv.classList.add("csl-entry");
                  var biblioDiv = window.document.getElementById("ref-" + cite);
                  if (biblioDiv) {
                    citeDiv.innerHTML = biblioDiv.innerHTML;
                  }
                  popup.appendChild(citeDiv);
                });
                return popup.innerHTML;
              });
            }
          }
        });
      </script>
    </div>
    <!-- /content -->
  </body>
</html>
